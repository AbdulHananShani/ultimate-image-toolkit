# This is the main block that defines a virtual server.
server {
    # Tells Nginx to listen for incoming HTTP traffic on port 80.
    # This is the standard port for all non-secure web traffic.
    listen 80;

    # This block handles requests for your CSS and JavaScript files.
    # Any URL that starts with "/static" will be handled here.
    location /static {
        # 'alias' tells Nginx: "Find these files in this specific folder on the server."
        # This path inside the container must match the path in docker-compose.yml.
        alias /var/www/static;
    }
    
    # This block handles requests for your user-uploaded images.
    # Any URL that starts with "/uploads" will be handled here.
    location /uploads {
        # 'alias' tells Nginx where to find the uploaded image files.
        alias /var/www/uploads;
    }

    # This is the "catch-all" block. It handles every other request
    # (like the homepage, tool pages, etc.).
    location / {
        # This is the most important line. It forwards the request to your
        # Python application, which is running on a container named 'web' on port 8000.
        proxy_pass http://web:8000;
        
        # These next two lines pass along important information about the original
        # user request so that your Flask application knows who it's talking to.
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}